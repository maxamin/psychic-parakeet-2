FROM debian:bullseye-slim AS builder

WORKDIR /tmp

RUN apt-get update && \
    apt-get install -y alien curl && \
    rm -rf /var/lib/apt/lists/*

ARG NMAP_VERSION=7.92

RUN curl https://nmap.org/dist/nmap-${NMAP_VERSION}-1.x86_64.rpm -o nmap.rpm && \
    alien --to-deb nmap.rpm && \
    mv *.deb nmap.deb

FROM debian:bullseye-slim

COPY --from=builder /tmp/nmap.deb /tmp

RUN dpkg --install /tmp/nmap.deb && \
    rm -rf /tmp/nmap.deb

ENTRYPOINT ["/usr/bin/nmap"]
